# Проект: Статистический анализ данных

<div class="Markdown base-markdown base-markdown_with-gallery markdown markdown_size_normal markdown_type_theory full-markdown"><h1>Проектная работа</h1><h3>Что такое проект</h3><div class="paragraph">Поздравляем! Вы прошли курс в тренажёре. Самое время проверить полученные знания на практике и решить аналитический кейс. Выполнять работу вы будете самостоятельно.  </div><div class="paragraph">Это проект с полностью автоматической проверкой. Он состоит из нескольких заданий.</div><div class="paragraph">В середине проекта есть ячейки с уже готовым кодом — просмотрите их, запустите, проанализируйте результат и переходите к следующим заданиям. Пока тренажёр не зачтёт все задания, пожалуйста, не добавляйте новый код к краткому исследовательскому анализу в этой части проекта.</div><div class="paragraph">Проект завершён, когда тренажёр примет все задания. После выполнения проекта вы по желанию можете вернуться к тетрадке и расширить приведённый в шаблоне исследовательский анализ данных по своему усмотрению. Проверяться вручную специалистом эта работа не будет.</div><h2><strong>Описание проекта</strong></h2><div class="paragraph">Вы аналитик компании «Мегалайн» — федерального оператора сотовой связи. Клиентам предлагают два тарифных плана: «Смарт» и «Ультра». Чтобы скорректировать рекламный бюджет, коммерческий департамент хочет понять, какой тариф приносит больше денег.</div><div class="paragraph">Вам предстоит сделать предварительный анализ тарифов на небольшой выборке клиентов. В вашем распоряжении данные 500 пользователей «Мегалайна»: кто они, откуда, каким тарифом пользуются, сколько звонков и сообщений каждый отправил за 2018-й год. Нужно проанализировать поведение клиентов и сделать вывод — какой тариф лучше.</div><h3>Описание тарифов</h3><div class="paragraph"><strong>Тариф «Смарт»</strong></div><ol start="1"><li>Ежемесячная плата: 550 рублей</li><li>Включено 500 минут разговора, 50 сообщений и 15 Гб интернет-трафика</li><li>Стоимость услуг сверх тарифного пакета:
 <ul><li>Минута разговора — 3 рубля. Количество использованных минут и мегабайтов «Мегалайн» всегда округляет вверх. Если пользователь проговорил всего 1 секунду, в тарифе засчитывается целая минута.</li><li>Сообщение — 3 рубля.</li><li>1 Гб интернет-трафика — 200 рублей.</li></ul></li></ol><div class="paragraph"><strong>Тариф «Ультра»</strong></div><ol start="1"><li>Ежемесячная плата: 1950 рублей</li><li>Включено 3000 минут разговора, 1000 сообщений и 30 Гб интернет-трафика</li><li>Стоимость услуг сверх тарифного пакета:
 <ul><li>Минута разговора — 1 рубль;</li><li>Сообщение — 1 рубль;</li><li>1 Гб интернет-трафика: 150 рублей.</li></ul></li></ol><div class="paragraph"><strong>Пути к файлам:</strong> </div><div class="paragraph"><a href="https://code.s3.yandex.net/datasets/calls.csv" target="_blank">/datasets/calls.csv</a></div><div class="paragraph"><a href="https://code.s3.yandex.net/datasets/internet.csv" target="_blank">/datasets/internet.csv</a></div><div class="paragraph"><a href="https://code.s3.yandex.net/datasets/messages.csv" target="_blank">/datasets/messages.csv</a></div><div class="paragraph"><a href="https://code.s3.yandex.net/datasets/tariffs.csv" target="_blank">/datasets/tariffs.csv</a></div><div class="paragraph"><a href="https://code.s3.yandex.net/datasets/users.csv" target="_blank">/datasets/users.csv</a></div><h3>Инструкция по выполнению проекта</h3><div class="paragraph"><strong>Шаг 1. Изучите общую информацию о данных из файла</strong></div><div class="paragraph"><strong>Задание 1.</strong> Откройте файл <code class="code-inline code-inline_theme_light">/datasets/calls.csv</code>, сохраните датафрейм в переменную <code class="code-inline code-inline_theme_light">calls</code>.</div><div class="paragraph"><strong>Задание 2.</strong> Выведите первые 5 строк датафрейма <code class="code-inline code-inline_theme_light">calls</code>.</div><div class="paragraph"><strong>Задание 3.</strong> Выведите основную информацию для датафрейма <code class="code-inline code-inline_theme_light">calls</code> с помощью метода <code class="code-inline code-inline_theme_light">info()</code>.</div><div class="paragraph"><strong>Задание 4.</strong> С помощью метода <code class="code-inline code-inline_theme_light">hist()</code> выведите гистограмму для столбца с продолжительностью звонков. Изучите распределение данных.</div><div class="paragraph"><strong>Задание 5.</strong> Откройте файл <code class="code-inline code-inline_theme_light">/datasets/internet.csv</code>, сохраните датафрейм в переменную <code class="code-inline code-inline_theme_light">sessions</code>.</div><div class="paragraph"><strong>Задание 6.</strong> Выведите первые 5 строк датафрейма <code class="code-inline code-inline_theme_light">sessions</code>.</div><div class="paragraph"><strong>Задание 7.</strong> Выведите основную информацию для датафрейма <code class="code-inline code-inline_theme_light">sessions</code> с помощью метода <code class="code-inline code-inline_theme_light">info()</code>. </div><div class="paragraph"><strong>Задание 8.</strong> С помощью метода <code class="code-inline code-inline_theme_light">hist()</code> выведите гистограмму для столбца с количеством потраченных мегабайт.</div><div class="paragraph"><strong>Задание 9.</strong> Откройте файл <code class="code-inline code-inline_theme_light">/datasets/messages.csv</code>, сохраните датафрейм в переменную <code class="code-inline code-inline_theme_light">messages</code>.</div><div class="paragraph"><strong>Задание 10.</strong> Выведите первые 5 строк датафрейма <code class="code-inline code-inline_theme_light">messages</code>.</div><div class="paragraph"><strong>Задание 11.</strong> Выведите основную информацию для датафрейма <code class="code-inline code-inline_theme_light">messages()</code> с помощью метода <code class="code-inline code-inline_theme_light">info()</code>. </div><div class="paragraph"><strong>Задание 12.</strong> Откройте файл <code class="code-inline code-inline_theme_light">/datasets/tariffs.csv</code>, сохраните датафрейм в переменную <code class="code-inline code-inline_theme_light">tariffs</code>.</div><div class="paragraph"><strong>Задание 13.</strong> Выведите весь датафрейм <code class="code-inline code-inline_theme_light">tariffs</code>.</div><div class="paragraph"><strong>Задание 14.</strong> Выведите основную информацию для датафрейма <code class="code-inline code-inline_theme_light">tariffs</code> с помощью метода <code class="code-inline code-inline_theme_light">info()</code>.</div><div class="paragraph"><strong>Задание 15.</strong> Откройте файл <code class="code-inline code-inline_theme_light">/datasets/users.csv</code>, сохраните датафрейм в переменную <code class="code-inline code-inline_theme_light">users</code>.</div><div class="paragraph"><strong>Задание 16.</strong> Выведите первые 5 строк датафрейма <code class="code-inline code-inline_theme_light">users</code>.</div><div class="paragraph"><strong>Задание 17.</strong> Выведите основную информацию для датафрейма <code class="code-inline code-inline_theme_light">users</code> с помощью метода <code class="code-inline code-inline_theme_light">info()</code>.</div><div class="paragraph"><strong>Шаг 2. Подготовьте данные</strong></div><div class="paragraph"><strong>Задание 18.</strong>  Приведите столбцы</div><ul><li><code class="code-inline code-inline_theme_light">reg_date</code> из таблицы <code class="code-inline code-inline_theme_light">users</code></li><li><code class="code-inline code-inline_theme_light">churn_date</code> из таблицы <code class="code-inline code-inline_theme_light">users</code></li><li><code class="code-inline code-inline_theme_light">call_date</code> из таблицы <code class="code-inline code-inline_theme_light">calls</code></li><li><code class="code-inline code-inline_theme_light">message_date</code> из таблицы <code class="code-inline code-inline_theme_light">messages</code></li><li><code class="code-inline code-inline_theme_light">session_date</code> из таблицы <code class="code-inline code-inline_theme_light">sessions</code></li></ul><div class="paragraph">к новому типу с помощью метода <code class="code-inline code-inline_theme_light">to_datetime()</code>.</div><div class="paragraph"><strong>Задание 19.</strong> В данных вы найдёте звонки с нулевой продолжительностью. Это не ошибка: нулями обозначены пропущенные звонки, поэтому их не нужно удалять.</div><div class="paragraph">Однако в столбце <code class="code-inline code-inline_theme_light">duration</code> датафрейма <code class="code-inline code-inline_theme_light">calls</code> значения дробные. Округлите значения столбца <code class="code-inline code-inline_theme_light">duration</code> вверх с помощью метода <code class="code-inline code-inline_theme_light">numpy.ceil()</code> и приведите столбец <code class="code-inline code-inline_theme_light">duration</code> к типу <code class="code-inline code-inline_theme_light">int</code>.</div><div class="paragraph"><strong>Задание 20.</strong> Удалите столбец <code class="code-inline code-inline_theme_light">Unnamed: 0</code> из датафрейма <code class="code-inline code-inline_theme_light">sessions</code>. Столбец с таким названием возникает, когда данные сохраняют с указанием индекса <code class="code-inline code-inline_theme_light">df.to_csv(..., index=column)</code>. Этот столбец сейчас не понадобится.</div><div class="paragraph"><strong>Задание 21.</strong> Создайте столбец <code class="code-inline code-inline_theme_light">month</code> в датафрейме <code class="code-inline code-inline_theme_light">calls</code> с номером месяца из столбца <code class="code-inline code-inline_theme_light">call_date</code>.</div><div class="paragraph"><strong>Задание 22.</strong> Создайте столбец <code class="code-inline code-inline_theme_light">month</code> в датафрейме <code class="code-inline code-inline_theme_light">messages</code> с номером месяца из столбца <code class="code-inline code-inline_theme_light">message_date</code>.</div><div class="paragraph"><strong>Задание 23.</strong> Создайте столбец <code class="code-inline code-inline_theme_light">month</code> в датафрейме <code class="code-inline code-inline_theme_light">sessions</code> с номером месяца из столбца <code class="code-inline code-inline_theme_light">session_date</code>.</div><div class="paragraph"><strong>Задание 24.</strong> Посчитайте количество сделанных звонков разговора для каждого пользователя по месяцам и сохраните в переменную <code class="code-inline code-inline_theme_light">calls_per_month</code>. Для этого нужно: </div><ul><li>сгруппировать датафрейм с информацией о звонках по двум столбцам — с идентификаторами пользователей и номерами месяцев;</li><li>затем применить метод для подсчёта количества: <code class="code-inline code-inline_theme_light">.agg({'duration': 'count'})</code>.</li></ul><div class="paragraph">Выведите первые 30 строчек <code class="code-inline code-inline_theme_light">calls_per_month</code>.</div><div class="paragraph"><strong>Задание 25.</strong> Посчитайте количество израсходованных минут разговора для каждого пользователя по месяцам и сохраните в переменную <code class="code-inline code-inline_theme_light">minutes_per_month</code>. Для этого нужно:</div><ul><li>сгруппировать датафрейм с информацией о звонках по двум столбцам — с идентификаторами пользователей и номерами месяцев;</li><li>затем применить метод для подсчёта суммы: <code class="code-inline code-inline_theme_light">.agg(minutes=('duration', 'sum'))</code>; так вы переименуете столбец в <code class="code-inline code-inline_theme_light">minutes</code> после вычисления суммы.</li></ul><div class="paragraph">Выведите первые 30 строчек <code class="code-inline code-inline_theme_light">minutes_per_month</code>.</div><div class="paragraph"><strong>Задание 26.</strong> Посчитайте количество отправленных сообщений по месяцам для каждого пользователя и сохраните в переменную <code class="code-inline code-inline_theme_light">messages_per_month</code>. Для этого нужно:</div><ul><li>сгруппировать датафрейм с информацией о сообщениях по двум столбцам — с идентификаторами пользователей и номерами месяцев;</li><li>затем применить метод для подсчёта количества: <code class="code-inline code-inline_theme_light">.agg(messages=('message_date', 'count'))</code>, так вы переименуете столбец в <code class="code-inline code-inline_theme_light">messages</code> после вычисления количества.</li></ul><div class="paragraph">Выведите первые 30 строчек <code class="code-inline code-inline_theme_light">messages_per_month</code>.</div><div class="paragraph"><strong>Задание 27.</strong> Посчитайте количество потраченных мегабайт по месяцам для каждого пользователя и сохраните в переменную <code class="code-inline code-inline_theme_light">sessions_per_month</code>. Для этого нужно:</div><ul><li>сгруппировать датафрейм с информацией о сообщениях по двум столбцам — с идентификаторами пользователей и номерами месяцев;</li><li>затем применить метод для подсчёта суммы: <code class="code-inline code-inline_theme_light">.agg({'mb_used': 'sum'})</code>.</li></ul><div class="paragraph"><strong>Шаг 3. Анализ данных</strong></div><div class="paragraph">Исследовательский анализ данных и подсчёт помесячной выручки уже есть в проекте. </div><div class="paragraph">Помесячная выручка вычисляется так:</div><ul><li>отнимите бесплатный лимит от суммарного количества звонков, сообщений и интернет-трафика;</li><li>остаток умножьте на значение из тарифного плана;</li><li>к результату прибавьте абонентскую плату, соответствующую тарифному плану.</li></ul><div class="paragraph">Запустите ячейки этого шага, изучите код и результат. Какие выводы можно сделать из результатов этого этапа?</div><div class="paragraph"><strong>Шаг 4. Проверьте гипотезы</strong></div><div class="paragraph">Проверьте две гипотезы о выручке пользователей. В качестве уровня значимости <em>alpha</em> возьмите 0.05 (5%).</div><div class="paragraph"><strong>Задание 28</strong></div><div class="paragraph">Проверьте гипотезу, что средняя выручка с пользователей тарифов «Ультра» и «Смарт» различается. Воспользуйтесь методом из библиотеки <code class="code-inline code-inline_theme_light">scipy</code> и выведите на экран значение <em>p-value:</em> только значение, без округления и пояснений.</div><div class="paragraph">Затем выведите на экран фразу «Отвергаем нулевую гипотезу», если есть основания отвергнуть нулевую гипотезу или фразу «Не получилось отвергнуть нулевую гипотезу», если оснований отвергнуть нулевую гипотезу нет. Здесь вам поможет условный оператор и сравнение получившегося <em>p-value</em> с заданным уровнем значимости.</div><div class="paragraph">Формат ответа должен быть таким:</div><div class="code-block code-block_theme_light"><div class="code-block__tools"><button class="code-block__clipboard" type="button">Скопировать код</button></div><div class="scrollable-default scrollable scrollable_theme_light code-block__scrollable"><div></div><div class="scrollable__content-wrapper"><div class="scrollbar-remover scrollable__content-container" style="--scroll-bar-width:18px; --scroll-bar-height:18px;"><div class="scrollable__content"><pre class="code-block__code-wrapper"><code class="code-block__code">...
Отвергаем нулевую гипотезу </code></pre><div></div></div></div></div><section class="scrollbar-default scrollbar scrollbar_vertical scrollbar_hidden scrollable__scrollbar scrollable__scrollbar_type_vertical" size="1" style="--scrollbar-offset-size:57px; --scrollbar-control-size:57px; --scrollbar-control-container-size:100%; --scrollbar-scale:1; --scrollbar-control-offset:0;"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section><section class="scrollbar-default scrollbar scrollbar_horizontal scrollbar_hidden scrollable__scrollbar scrollable__scrollbar_type_horizontal" size="1" style="--scrollbar-offset-size:688px; --scrollbar-control-size:688px; --scrollbar-control-container-size:100%; --scrollbar-scale:1; --scrollbar-control-offset:0;"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section></div></div><div class="paragraph">или</div><div class="python code-block code-block_theme_light"><div class="code-block__tools"><button class="code-block__clipboard" type="button">Скопировать код</button><span class="code-block__lang">PYTHON</span></div><div class="scrollable-default scrollable scrollable_theme_light code-block__scrollable"><div></div><div class="scrollable__content-wrapper"><div class="scrollbar-remover scrollable__content-container" style="--scroll-bar-width:18px; --scroll-bar-height:18px;"><div class="scrollable__content"><pre class="code-block__code-wrapper"><code class="code-block__code python">...
Не получилось отвергнуть нулевую гипотезу </code></pre><div></div></div></div></div><section class="scrollbar-default scrollbar scrollbar_vertical scrollbar_hidden scrollable__scrollbar scrollable__scrollbar_type_vertical" size="1" style="--scrollbar-offset-size:57px; --scrollbar-control-size:57px; --scrollbar-control-container-size:100%; --scrollbar-scale:1; --scrollbar-control-offset:0;"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section><section class="scrollbar-default scrollbar scrollbar_horizontal scrollbar_hidden scrollable__scrollbar scrollable__scrollbar_type_horizontal" size="1" style="--scrollbar-offset-size:688px; --scrollbar-control-size:688px; --scrollbar-control-container-size:100%; --scrollbar-scale:1; --scrollbar-control-offset:0;"><div class="scrollbar__control-container"><div class="scrollbar__control"><div class="scrollbar__control-line"></div></div></div></section></div></div><div class="paragraph">Где <code class="code-inline code-inline_theme_light">…</code> — это значение <em>p-value</em>.</div><div class="paragraph"><strong>Задание 29</strong></div><div class="paragraph">Проверьте гипотезу, что средняя выручка с пользователей из Москвы отличается от выручки с пользователей других регионов. Воспользуйтесь методом из библиотеки <code class="code-inline code-inline_theme_light">scipy</code> и выведите на экран значение <em>p-value</em>. Формат вывода полностью аналогичен предыдущему заданию.</div><div class="paragraph"><strong>Оформление:</strong>&nbsp;Выполните задание в&nbsp;<em>Jupyter Notebook</em>. Заполните программный код в ячейках типа&nbsp;<em>code,</em>&nbsp;текстовые пояснения — в ячейках типа&nbsp;<em>markdown</em>. Примените форматирование и заголовки.</div><h3>Описание данных</h3><div class="paragraph">Таблица <code class="code-inline code-inline_theme_light">users</code> — информация о пользователях:</div><ul><li><code class="code-inline code-inline_theme_light">user_id</code> — уникальный идентификатор пользователя</li><li><code class="code-inline code-inline_theme_light">first_name</code> — имя пользователя</li><li><code class="code-inline code-inline_theme_light">last_name</code> — фамилия пользователя</li><li><code class="code-inline code-inline_theme_light">age</code> — возраст пользователя (годы)</li><li><code class="code-inline code-inline_theme_light">reg_date</code> — дата подключения тарифа (день, месяц, год)</li><li><code class="code-inline code-inline_theme_light">churn_date</code> — дата прекращения пользования тарифом (если значение пропущено, значит, тариф ещё действовал на момент выгрузки данных)</li><li><code class="code-inline code-inline_theme_light">city</code> — город проживания пользователя</li><li><code class="code-inline code-inline_theme_light">tarif</code> — название тарифного плана</li></ul><div class="paragraph">Таблица <code class="code-inline code-inline_theme_light">calls</code> — информация о звонках:</div><ul><li><code class="code-inline code-inline_theme_light">id</code> — уникальный номер звонка</li><li><code class="code-inline code-inline_theme_light">call_date</code> — дата звонка</li><li><code class="code-inline code-inline_theme_light">duration</code> — длительность звонка в минутах</li><li><code class="code-inline code-inline_theme_light">user_id</code> — идентификатор пользователя, сделавшего звонок</li></ul><div class="paragraph">Таблица <code class="code-inline code-inline_theme_light">messages</code> — информация о сообщениях:</div><ul><li><code class="code-inline code-inline_theme_light">id</code> — уникальный номер звонка</li><li><code class="code-inline code-inline_theme_light">message_date</code> — дата сообщения</li><li><code class="code-inline code-inline_theme_light">user_id</code> — идентификатор пользователя, отправившего сообщение</li></ul><div class="paragraph">Таблица <code class="code-inline code-inline_theme_light">internet</code> — информация об интернет-сессиях:</div><ul><li><code class="code-inline code-inline_theme_light">id</code> — уникальный номер сессии</li><li><code class="code-inline code-inline_theme_light">mb_used</code> —  объём потраченного за сессию интернет-трафика (в мегабайтах)</li><li><code class="code-inline code-inline_theme_light">session_date</code> — дата интернет-сессии</li><li><code class="code-inline code-inline_theme_light">user_id</code> — идентификатор пользователя</li></ul><div class="paragraph">Таблица <code class="code-inline code-inline_theme_light">tariffs</code> — информация о тарифах:</div><ul><li><code class="code-inline code-inline_theme_light">tariff_name</code> — название тарифа</li><li><code class="code-inline code-inline_theme_light">rub_monthly_fee</code> — ежемесячная абонентская плата в рублях</li><li><code class="code-inline code-inline_theme_light">minutes_included</code> — количество минут разговора в месяц, включённых в абонентскую плату</li><li><code class="code-inline code-inline_theme_light">messages_included</code> — количество сообщений в месяц, включённых в абонентскую плату</li><li><code class="code-inline code-inline_theme_light">mb_per_month_included</code> — объём интернет-трафика, включённого в&nbsp;абонентскую плату (в мегабайтах)</li><li><code class="code-inline code-inline_theme_light">rub_per_minute</code> — стоимость минуты разговора сверх тарифного пакета (например, если в тарифе 100 минут разговора в месяц, то со 101 минуты будет взиматься плата)</li><li><code class="code-inline code-inline_theme_light">rub_per_message</code> — стоимость отправки сообщения сверх тарифного пакета</li><li><code class="code-inline code-inline_theme_light">rub_per_gb</code> — стоимость дополнительного гигабайта интернет-трафика сверх тарифного пакета (1 гигабайт = 1024 мегабайта)</li></ul></div> 
